[[extend 'layout.html']]

<style>
    [v-cloak] {
        display: none;
    }
    .timeslot {
        font-size: 15px;
    }
    .row {
        height: 30px;
    }
    .schedule_cell {
        opacity: 75%;
    }
    #save_button {
        position: relative;
        float: right;
    }
</style>

<div class="section" id="vue-target" v-cloak>
    <a class="button" href="[[=URL('index')]]">
        <span class="icon"><i class="fa fa-arrow-left"></i></span>
        <span>Back</span>
    </a>

    <h1 class="title has-text-centered">[[=first]] [[=last]]'s Schedule</h1>
    <h6 class="title is-6 has-text-centered">[[=email]]</h6>

    <!-- [[=form]] -->

    <button class="button is-danger" @click="schedule_clear">
        <span class="icon"><i class="fa fa-trash"></i></span>
        <span>Clear Schedule</span>
    </button>
    <button class="button is-success" @click="schedule_save" id="save_button">
        <span class="icon"><i class="fa fa-save"></i></span>
        <span>Save Schedule</span>
    </button>

    <div class="section">
        <table class="table is-striped is-fullwidth has-text-centered is-narrow is-bordered" id="schedule">
            <thead>
                <th style="width: 50px; font-size: 15px">
                    <label class="checkbox">
                        <input type="checkbox" v-model="extended" @change="toggle_extended" />
                        Extended Schedule
                    </label>
                </th>
            [[for day in ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']:]]
                <th style="width: 100px">[[=day]]</th>
            [[pass]]
            </thead>

            <tbody v-for="i in timeslots">
                <tr v-if="i%2==0" class="row">
                    <td class="timeslot">{{((i<=24&&i!=0) ? i/2 : Math.abs(i/2-12)) + (i<=24 ? ' AM' : ' PM')}}</td>
                    [[for j in range(7):]]
                        <td @mouseenter="schedule_enter(i, ([[=j]]), false)"
                        @mousedown="schedule_enter(i, ([[=j]]), true)"
                        :class="{
                            'is-primary': cells[i][([[=j]])],
                            'is-none': !cells[i][([[=j]])],
                        }"
                        class="schedule_cell"></td>
                    [[pass]]
                </tr>
                <tr v-if="i%2==1" class="row">
                    <td></td>
                    [[for j in range(7):]]
                        <td @mouseenter="schedule_enter(i, ([[=j]]), false)"
                        @mousedown="schedule_enter(i, ([[=j]]), true)"
                        :class="{
                            'is-primary': cells[i][([[=j]])],
                            'is-none': !cells[i][([[=j]])],
                        }"
                        class="schedule_cell"></td>
                    [[pass]]
                </tr> 
                    
            </tbody>

        </table>

        <button class="button is-danger" @click="schedule_clear">
            <span class="icon"><i class="fa fa-trash"></i></span>
            <span>Clear Schedule</span>
        </button>
        <button class="button is-success" @click="schedule_save" id="save_button">
            <span class="icon"><i class="fa fa-save"></i></span>
            <span>Save Schedule</span>
        </button>

    </div>
</div>

[[block page_scripts]]
<script>
    let load_schedule_url = "[[=XML(load_schedule_url)]]";
</script>
<script src="js/schedule.js"></script>
[[end]]